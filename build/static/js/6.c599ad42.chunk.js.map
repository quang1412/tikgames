{"version":3,"sources":["games/wheelOfFortune/style.module.css","games/wheelOfFortune/index.jsx"],"names":["module","exports","defaultSettings","tiktokId","commentKey","follower","friend","giftCount","giftName","joinEvent","maxPlayer","unfollower","winnerShowDuration","window","wheelSoundTrigger","console","log","WheelBackground","useState","index","setindex","useEffect","i","setTimeout","clearTimeout","className","style","wheelBg","backgroundImage","Wheel","props","players","keys","Object","segments","length","map","uniqueId","player","id","text","name","nickname","fillStyle","textFillStyle","image","profilePictureUrl","wheel","Winwheel","numSegments","responsive","innerRadius","size","outerRadius","centerY","centerX","textFontSize","lineWidth","animation","type","easing","duration","spins","soundTrigger","callbackFinished","pins","number","rotationAngle","draw","createWheel","stopAnimation","e","wheelCanvas","width","height","Winner","info","isShow","setShow","marginTop","onAnimationEnd","target","classList","remove","add","removeEventListener","addEventListener","textShadow","alt","src","onError","imageOnError","TutorialCard","settings","playerCount","show","O","key","push","fontSize","join","JoinedPlayer","container","document","getElementById","handleAnimationEnd","onanimationend","lastPlayer","values","pop","createElement","imageUrlFixing","defaultAvatar","setAttribute","marginLeft","randomInt","appendChild","memo","event","setting_1","updateSettings","setPlayers","canJoin","setCanjoin","winner","setWinner","isSpining","setIsSpining","validFollowrRole","0","1","2","followRole","resetWheel","current","valid","comment","includes","giftType","repeatCount","repeatEnd","Math","floor","random","startAnimation","wheelFinished","winningSegment","getIndicatedSegment","warn","zIndex"],"mappings":"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","file":"static/js/6.c599ad42.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"html\":\"style_html__xRU5M\",\"App\":\"style_App__318US\",\"gameScreen\":\"style_gameScreen__14i96\",\"wheel\":\"style_wheel__17HAv\",\"header\":\"style_header__2tiKQ\",\"info\":\"style_info__1Cjzb\",\"wheelContainer\":\"style_wheelContainer__3YLa_\",\"wheelBg\":\"style_wheelBg__3-dAe\",\"wheelCanvas\":\"style_wheelCanvas__2rjVB\",\"actions\":\"style_actions__ZkXv3\",\"modal\":\"style_modal__2xGNW\"};","import React, { useEffect, useState, memo } from \"react\"\n// import { useOutletContext } from \"react-router-dom\"\nimport style from \"./style.module.css\"\nimport Winwheel from \"winwheel\"\n\nconst size = 400\nconst defaultSettings = {\n  tiktokId: \"\",\n  commentKey: \"JOIN\",\n  follower: true,\n  friend: true,\n  giftCount: 1,\n  giftName: \"rose\",\n  joinEvent: \"chat\",\n  maxPlayer: 100,\n  unfollower: true,\n  winnerShowDuration: 10,\n}\n\nwindow.wheelSoundTrigger = () => console.log(\"play sound\")\n\nconst WheelBackground = () => {\n  const [index, setindex] = useState(0)\n\n  useEffect(() => {\n    const i = setTimeout(() => setindex(1 - index), 1000)\n    return () => clearTimeout(i)\n  }, [index])\n\n  return (\n    <>\n      <div\n        className={style.wheelBg + (index ? \" d-none\" : \"\")}\n        style={{\n          backgroundImage: `url('/assets/images/wheel-of-fortune-bg-1.webp')`,\n        }}\n      ></div>\n      <div\n        className={style.wheelBg + (!index ? \" d-none\" : \"\")}\n        style={{\n          backgroundImage: `url('/assets/images/wheel-of-fortune-bg-2.webp')`,\n        }}\n      ></div>\n    </>\n  )\n}\n\nconst Wheel = (props) => {\n  const { players } = props\n\n  useEffect(() => {\n    function createWheel() {\n      const keys = Object.keys(players)\n      const segments = !keys.length\n        ? [\n            {\n              fillStyle: \"#ff0000\",\n              textFillStyle: \"#ff0000\",\n              text: \"\",\n            },\n          ]\n        : keys.map((uniqueId, index) => {\n            const player = players[uniqueId]\n            return {\n              id: player.uniqueId,\n              text: player.uniqueId,\n              name: player.nickname || \"\",\n              fillStyle: index % 2 === 0 ? \"#ff0000\" : \"#ffffff\",\n              textFillStyle: index % 2 === 0 ? \"#ffffff\" : \"#ff0000\",\n              image: player.profilePictureUrl,\n            }\n          })\n      window.wheel = new Winwheel({\n        numSegments: segments.length,\n        responsive: true,\n        innerRadius: (size / 2) * 0.08,\n        outerRadius: (size / 2) * 0.725,\n        centerY: (size / 2) * 0.9,\n        centerX: size / 2,\n        textFontSize: (size / 2) * 0.07,\n        lineWidth: 1,\n        segments: segments,\n        animation: {\n          type: \"spinToStop\",\n          easing: \"Power2.easeOut\",\n          duration: 30,\n          spins: 30,\n          // callbackSound: \"window.wheelSoundTrigger()\",\n          soundTrigger: \"pin\",\n          callbackFinished: \"window.wheelFinished()\",\n        },\n        pins: {\n          number: segments.length,\n          responsive: true,\n          outerRadius: 0,\n        },\n      })\n      window.wheel.rotationAngle = 0\n      window.wheel.draw()\n    }\n\n    createWheel()\n\n    return () => {\n      try {\n        window.wheel.stopAnimation(false)\n      } catch (e) {}\n      window.wheel = null\n    }\n  }, [players])\n\n  return (\n    <canvas\n      className={style.wheelCanvas}\n      id=\"canvas\"\n      width={size}\n      height={size}\n    >\n      Canvas not supported, use another browser.\n    </canvas>\n  )\n}\n\nconst Winner = (props) => {\n  const { info, duration } = props\n  const [isShow, setShow] = useState(true)\n\n  function onAnimationEnd(e) {\n    const target = e.target\n    target.classList.remove(\"animate__zoomInDown\")\n    setTimeout(() => {\n      target.classList.add(\"animate__fadeOut\")\n      target.removeEventListener(\"animationend\", onAnimationEnd)\n      target.addEventListener(\"animationend\", () => {\n        setShow(false)\n      })\n    }, duration * 1000)\n  }\n  return (\n    isShow && (\n      <div\n        className=\"animate__animated animate__zoomInDown h-100 text-center d-flex flex-column justify-content-center align-items-center\"\n        style={{ marginTop: \"-40px\" }}\n        onAnimationEnd={onAnimationEnd}\n      >\n        <span\n          className=\"fw-bolder fs-4 text-info\"\n          style={{\n            textShadow:\n              \"2px 2px 0 #ffffff, 2px -2px 0 #ffffff, -2px 2px 0 #ffffff, -2px -2px 0 #ffffff, 2px 0px 0 #ffffff, 0px 2px 0 #ffffff, -2px 0px 0 #ffffff, 0px -2px 0 #ffffff\",\n          }}\n        >\n          WINNER\n        </span>\n        <img\n          className=\"d-block rounded-circle mx-auto border border-5 border-info\"\n          width=\"150\"\n          height=\"150\"\n          alt=\"winner\"\n          src={info.image}\n          onError={window.imageOnError}\n        />\n        <span\n          className=\"fw-bolder fs-4 text-info lh-1\"\n          style={{\n            textShadow:\n              \"2px 2px 0 #ffffff, 2px -2px 0 #ffffff, -2px 2px 0 #ffffff, -2px -2px 0 #ffffff, 2px 0px 0 #ffffff, 0px 2px 0 #ffffff, -2px 0px 0 #ffffff, 0px -2px 0 #ffffff\",\n          }}\n        >\n          {info.name}\n          <br />\n          <small className=\"fs-6\">{info.text}</small>\n        </span>\n      </div>\n    )\n  )\n}\n\nconst TutorialCard = ({ settings, playerCount, show }) => {\n  const O = {\n    \"bạn bè\": settings.friend,\n    \"người theo dõi\": settings.follower,\n    \"chưa theo dõi\": settings.unfollower,\n  }\n  const players = []\n  for (const key in O) {\n    O[key] && players.push(key)\n  }\n  return (\n    <div\n      style={{ fontSize: \".8rem\", width: \"85%\" }}\n      className={\n        \"bg-light border border-1 text-dark text-start p-2 rounded-5 mx-auto animate__animated \" +\n        (show ? \"animate__flipInX\" : \"animate__flipOutX\")\n      }\n    >\n      <p className=\"mb-0 text-nowrap\">- Người chơi: {players.join(\" / \")}</p>\n      <p className=\"mb-0 text-nowrap\">\n        - Điều kiện:{\" \"}\n        {settings.joinEvent === \"chat\" ? (\n          <>\n            comment nội dung\n            <span className=\"text-danger ms-2\">{settings.commentKey}</span>\n          </>\n        ) : (\n          settings.joinEvent === \"gift\" && (\n            <>\n              tặng tối thiểu combo\n              <span className=\"text-danger ms-2\">\n                {settings.giftCount} {settings.giftName}\n              </span>\n            </>\n          )\n        )}\n      </p>\n      <p className=\"mb-0 text-nowrap\">\n        - Đã tham gia: {playerCount + \" / \" + settings.maxPlayer}\n      </p>\n    </div>\n  )\n}\n\nconst JoinedPlayer = ({ players, show }) => {\n  const container = document.getElementById(\"joined-players\")\n\n  const handleAnimationEnd = (e) => {\n    e.target.classList.remove(\"animate__backInUp\", \"opacity-100\")\n    setTimeout(() => {\n      e.target.classList.add(\"animate__zoomOut\")\n    }, 3000)\n    e.target.onanimationend = e.target.remove\n  }\n\n  useEffect(() => {\n    const lastPlayer = Object.values(players).pop()\n    const image = window.document.createElement(\"img\")\n    image.src = window.imageUrlFixing(\n      lastPlayer?.profilePictureUrl || window.defaultAvatar\n    )\n    image.className =\n      \"position-absolute start-0 top-0 rounded-circle rounded-circle border border-light border-5 opacity-100 animate__animated animate__slow animate__backInUp\"\n    image.setAttribute(\"width\", 80)\n    image.setAttribute(\"height\", 80)\n    image.onanimationend = handleAnimationEnd\n    image.style.marginLeft = window.randomInt(0, 320) + \"px\"\n    image.style.marginTop = window.randomInt(0, 320) + \"px\"\n\n    lastPlayer &&\n      setTimeout(() => {\n        container.appendChild(image)\n      }, window.randomInt(100, 500))\n  }, [players])\n\n  return (\n    <div\n      className={\n        \"position-relative \" + (!show && \"animate__animated animate__zoomOut\")\n      }\n      id=\"joined-players\"\n    ></div>\n  )\n}\n\nfunction WheelofFortune({ event, settings }) {\n  const [setting_1, updateSettings] = useState(defaultSettings)\n  const [players, setPlayers] = useState({})\n  const [canJoin, setCanjoin] = useState(true)\n  const [winner, setWinner] = useState(false)\n  const [isSpining, setIsSpining] = useState(false)\n\n  function startSpin() {\n    if (Object.keys(players).length < 2 || isSpining) return\n    window.wheel.rotationAngle = Math.floor(Math.random() * 359) + 1\n    window.wheel.draw()\n    window.wheel.startAnimation()\n    setCanjoin(false)\n    setWinner(false)\n    setIsSpining(true)\n  }\n\n  function resetWheel() {\n    try {\n      window.wheel.stopAnimation(false)\n    } catch (e) {}\n    window.wheel.rotationAngle = 0\n    window.wheel.draw()\n    setPlayers({})\n    setIsSpining(false)\n    setCanjoin(true)\n    setWinner(false)\n  }\n\n  useEffect(() => {\n    settings && updateSettings(settings)\n  }, [settings])\n\n  useEffect(() => {\n    const validFollowrRole = {\n      0: setting_1.unfollower,\n      1: setting_1.follower,\n      2: setting_1.friend,\n    }\n\n    const { name, uniqueId, nickname, profilePictureUrl, followRole } = event\n\n    if (name === \"spin\") return startSpin()\n    if (name === \"restart\") return resetWheel()\n    setPlayers((current) => {\n      // if (!window.cid) return demoPlayer\n\n      const isLimit = Object.keys(current).length >= setting_1.maxPlayer\n      if (isLimit || !canJoin) return current\n\n      const isJoined = current[uniqueId]\n      if (\n        isJoined ||\n        name !== setting_1.joinEvent ||\n        !validFollowrRole[followRole]\n      )\n        return current\n\n      var valid\n      switch (name) {\n        case \"chat\":\n          const { comment } = event\n          valid = comment && comment.includes(setting_1.commentKey)\n          break\n        case \"gift\":\n          const { giftType, giftName, repeatCount, repeatEnd } = event\n          if (giftType === 1 && !repeatEnd) break\n          valid =\n            giftName === setting_1.giftName && repeatCount < setting_1.giftCount\n          break\n        default:\n      }\n      return valid\n        ? { ...current, [uniqueId]: { uniqueId, nickname, profilePictureUrl } }\n        : current\n    })\n  }, [event, canJoin, setting_1])\n\n  useEffect(() => {\n    window.wheelFinished = () => {\n      let winningSegment = window.wheel.getIndicatedSegment()\n      setWinner(winningSegment.id ? winningSegment : false)\n      setIsSpining(false)\n      console.warn(winningSegment.text, \"is winner\")\n    }\n    return () => {\n      window.wheelFinished = null\n    }\n  }, [])\n\n  return (\n    <div\n      className=\"position-relative mx-auto p-2\"\n      style={{ width: `${size}px`, height: `${size}px` }}\n    >\n      <TutorialCard\n        settings={setting_1}\n        playerCount={Object.keys(players).length}\n        show={canJoin}\n      />\n      <div\n        className=\"position-absolute w-100 text-center\"\n        style={{ zIndex: \"1\" }}\n      >\n        <JoinedPlayer players={players} show={canJoin} />\n      </div>\n      <div className=\"position-absolute  \">\n        <Wheel players={players} />\n      </div>\n      <div className=\"position-absolute w-100 h-100\">\n        <WheelBackground />\n      </div>\n      <div className=\"position-absolute w-100 h-100\">\n        {winner && winner.id && (\n          <Winner info={winner} duration={setting_1.winnerShowDuration || 10} />\n        )}\n      </div>\n    </div>\n  )\n}\nexport default memo(WheelofFortune)\n"],"sourceRoot":""}