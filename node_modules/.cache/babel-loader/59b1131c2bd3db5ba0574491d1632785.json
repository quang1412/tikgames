{"ast":null,"code":"var _jsxFileName = \"/Users/trinhdacquang/React/tikgames/src/Widget/index.jsx\";\nimport React, { useState, useEffect } from \"react\";\nimport { Outlet } from \"react-router-dom\";\nimport io from \"socket.io-client\";\nimport Game from \"../Game\";\nimport \"./style.module.css\";\nconst socket = io(\"/widget\", {\n  path: \"/socket\",\n  query: {\n    cid: new URLSearchParams(document.location.search).get(\"cid\")\n  }\n});\nexport default function Widget() {\n  const [event, setEvent] = useState({});\n  const [settings, updateSettings] = useState({});\n  const [isConnected, setIsConnected] = useState(false);\n  const addListener = () => {\n    socket.on(\"tiktok-gift\", data => {\n      setEvent(data);\n    });\n    socket.on(\"tiktok-chat\", data => {\n      setEvent(data);\n    });\n    socket.on(\"tiktok-like\", data => {\n      setEvent(data);\n    });\n    socket.on(\"tiktok-share\", data => {\n      setEvent(data);\n    });\n    socket.on(\"tiktok-follow\", data => {\n      setEvent(data);\n    });\n    socket.on(\"control\", action => {\n      setEvent({\n        name: action\n      });\n    });\n  };\n  const removeListener = () => {\n    socket.off(\"tiktok-gift\");\n    socket.off(\"tiktok-follow\");\n    socket.off(\"tiktok-share\");\n    socket.off(\"tiktok-like\");\n    socket.off(\"tiktok-chat\");\n  };\n  useEffect(() => {\n    socket.on(\"connect\", () => {\n      setIsConnected(true);\n    });\n    socket.on(\"disconnect\", () => {\n      setIsConnected(false);\n    });\n    socket.on(\"updateSettings\", data => {\n      updateSettings(data);\n    });\n    addListener();\n    return () => {\n      socket.off(\"connect\");\n      socket.off(\"disconnect\");\n      socket.off(\"uodateSettings\");\n      removeListener();\n    };\n  }, []);\n  return isConnected ? /*#__PURE__*/React.createElement(Game, {\n    settings: settings,\n    event: event,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 5\n    }\n  }) :\n  /*#__PURE__*/\n  // <Outlet context={[event, settings]} />\n  React.createElement(\"h5\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 5\n    }\n  }, \"server connecting...\");\n}","map":{"version":3,"names":["React","useState","useEffect","Outlet","io","Game","socket","path","query","cid","URLSearchParams","document","location","search","get","Widget","event","setEvent","settings","updateSettings","isConnected","setIsConnected","addListener","on","data","action","name","removeListener","off"],"sources":["/Users/trinhdacquang/React/tikgames/src/Widget/index.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\"\nimport { Outlet } from \"react-router-dom\"\nimport io from \"socket.io-client\"\nimport Game from \"../Game\"\nimport \"./style.module.css\"\n\nconst socket = io(\"/widget\", {\n  path: \"/socket\",\n  query: {\n    cid: new URLSearchParams(document.location.search).get(\"cid\"),\n  },\n})\n\nexport default function Widget() {\n  const [event, setEvent] = useState({})\n  const [settings, updateSettings] = useState({})\n  const [isConnected, setIsConnected] = useState(false)\n\n  const addListener = () => {\n    socket.on(\"tiktok-gift\", (data) => {\n      setEvent(data)\n    })\n\n    socket.on(\"tiktok-chat\", (data) => {\n      setEvent(data)\n    })\n\n    socket.on(\"tiktok-like\", (data) => {\n      setEvent(data)\n    })\n\n    socket.on(\"tiktok-share\", (data) => {\n      setEvent(data)\n    })\n\n    socket.on(\"tiktok-follow\", (data) => {\n      setEvent(data)\n    })\n\n    socket.on(\"control\", (action) => {\n      setEvent({ name: action })\n    })\n  }\n  const removeListener = () => {\n    socket.off(\"tiktok-gift\")\n    socket.off(\"tiktok-follow\")\n    socket.off(\"tiktok-share\")\n    socket.off(\"tiktok-like\")\n    socket.off(\"tiktok-chat\")\n  }\n\n  useEffect(() => {\n    socket.on(\"connect\", () => {\n      setIsConnected(true)\n    })\n    socket.on(\"disconnect\", () => {\n      setIsConnected(false)\n    })\n    socket.on(\"updateSettings\", (data) => {\n      updateSettings(data)\n    })\n    addListener()\n\n    return () => {\n      socket.off(\"connect\")\n      socket.off(\"disconnect\")\n      socket.off(\"uodateSettings\")\n      removeListener()\n    }\n  }, [])\n\n  return isConnected ? (\n    <Game settings={settings} event={event} />\n  ) : (\n    // <Outlet context={[event, settings]} />\n    <h5>server connecting...</h5>\n  )\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}