{"ast":null,"code":"var _jsxFileName = \"/Users/trinhdacquang/React/tikgames/src/Widget/index.jsx\";\nimport React, { useEffect, useState, memo } from \"react\";\nimport io from \"socket.io-client\";\nimport style from \"./style.module.css\";\nimport Winwheel from \"winwheel\";\nconst cid = new URLSearchParams(document.location.search).get(\"cid\");\nconst wsocket = io(\"/widget\", {\n  path: \"/socket\",\n  query: {\n    cid: cid\n  }\n});\nconsole.log(wsocket);\nconst size = 400;\nconst demoPlayer = {\n  cao_bay_37: {\n    uniqueId: \"cao_bay_37\",\n    nickname: \"cao_bay_37-\",\n    profilePictureUrl: \"https://p16-sign-sg.tiktokcdn.com/aweme/100x100/tos-alisg-avt-0068/b7ab24fd72c1d52d9d108b32d0226bec.webp?x-expires=1664269200&x-signature=vis%2BIdLcWF3zJr%2FA47EwW1eR%2FDY%3D\"\n  },\n  tuanbo_01: {\n    uniqueId: \"tuanbo_01\",\n    nickname: \"Tu·∫•n B√≤\",\n    profilePictureUrl: \"https://p16-sign-sg.tiktokcdn.com/aweme/100x100/tiktok-obj/1670424726689794.webp?x-expires=1664269200&x-signature=0L6agIQAKRVwHTLELPBev6Vd6zc%3D\"\n  },\n  pown_mai_69: {\n    uniqueId: \"pown_mai_69\",\n    nickname: \"Con qu·ª∑ ƒëen v√¥ danh\",\n    profilePictureUrl: \"https://p16-sign-sg.tiktokcdn.com/aweme/100x100/tos-alisg-avt-0068/9905f7201fbcfd69cafb8ce0f778e636.webp?x-expires=1664269200&x-signature=huOnbrj1nXEfhRi4HoW1nIJChmk%3D\"\n  },\n  \"3003831393nam\": {\n    uniqueId: \"3003831393nam\",\n    nickname: \"Nam2004‚ô•\",\n    profilePictureUrl: \"https://p16-sign-va.tiktokcdn.com/tos-useast2a-avt-0068-giso/5748581ae3eecff6249d5a89cd4c2065~c5_100x100.webp?x-expires=1664269200&x-signature=hz5JfOVxIOPr3gPx2ex8snZ6Qos%3D\"\n  },\n  quangphucshopee: {\n    uniqueId: \"quangphucshopee\",\n    nickname: \"PhucSadRoi\",\n    profilePictureUrl: \"https://p16-sign-va.tiktokcdn.com/tos-useast2a-avt-0068-giso/439214fa941c4be353b889120a0e69f5~c5_100x100.webp?x-expires=1664269200&x-signature=NeJmP16WXALETssCZlkAcYsnV0o%3D\"\n  },\n  quanpham14082022: {\n    uniqueId: \"quanpham14082022\",\n    nickname: \"Qu√¢nph·∫°m14082022\",\n    profilePictureUrl: \"https://p16-sign-va.tiktokcdn.com/musically-maliva-obj/1594805258216454~c5_100x100.webp?x-expires=1664269200&x-signature=pRXIh6syPbYNGe4QIBGIg0jB0YE%3D\"\n  },\n  huudai184: {\n    uniqueId: \"huudai184\",\n    nickname: \"Nguy·ªÖn H·ªØu ƒê·∫°i\",\n    profilePictureUrl: \"https://p16-sign-sg.tiktokcdn.com/aweme/100x100/tos-alisg-avt-0068/1c0882310d8257e56db42779d703841d.webp?x-expires=1664269200&x-signature=lEL89272xFn1EzI1xXeWKiq2D0I%3D\"\n  },\n  facebook_phamcong: {\n    uniqueId: \"facebook_phamcong\",\n    nickname: \"üçÅ\",\n    profilePictureUrl: \"https://p16-sign-sg.tiktokcdn.com/aweme/100x100/tos-alisg-avt-0068/7c4d3130cea590c23504e44112f89398.webp?x-expires=1664269200&x-signature=KbKC2lqdPD1j5tlRI4SmDN0lA7Y%3D\"\n  },\n  trungtutin: {\n    uniqueId: \"trungtutin\",\n    nickname: \"Trung T·ª± tin\",\n    profilePictureUrl: \"https://p16-sign-sg.tiktokcdn.com/aweme/100x100/tos-alisg-avt-0068/1fe3707fa4397ddcaa82c8f06c39fe9d.webp?x-expires=1664269200&x-signature=EXWc1zZtVx%2Btza9q0z3aReZx5XE%3D\"\n  },\n  utnghia945: {\n    uniqueId: \"utnghia945\",\n    nickname: \"utnghia945\",\n    profilePictureUrl: \"https://p16-sign-va.tiktokcdn.com/tos-useast2a-avt-0068-giso/7144934450743214107~c5_100x100.webp?x-expires=1664269200&x-signature=rNdK6QvOGwDy6t8yKO%2F9LQ4xcIM%3D\"\n  }\n};\nwindow.wheelSoundTrigger = () => console.log(\"play sound\");\nconst WheelBackground = () => {\n  const [index, setindex] = useState(0);\n  useEffect(() => {\n    const i = setTimeout(() => setindex(1 - index), 1000);\n    return () => clearTimeout(i);\n  }, [index]);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: style.wheelBg + (index ? \" d-none\" : \"\"),\n    style: {\n      backgroundImage: `url('/assets/images/wheel-of-fortune-bg-1.webp')`\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: style.wheelBg + (!index ? \" d-none\" : \"\"),\n    style: {\n      backgroundImage: `url('/assets/images/wheel-of-fortune-bg-2.webp')`\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 7\n    }\n  }));\n};\nconst Wheel = props => {\n  const {\n    players\n  } = props;\n  useEffect(() => {\n    function createWheel() {\n      const keys = Object.keys(players);\n      const segments = !keys.length ? [{\n        fillStyle: \"#ff0000\",\n        textFillStyle: \"#ff0000\",\n        text: \"\"\n      }] : keys.map((uniqueId, index) => {\n        const player = players[uniqueId];\n        return {\n          id: player.uniqueId,\n          text: player.uniqueId,\n          name: player.nickname || \"\",\n          fillStyle: index % 2 === 0 ? \"#ff0000\" : \"#ffffff\",\n          textFillStyle: index % 2 === 0 ? \"#ffffff\" : \"#ff0000\",\n          image: player.profilePictureUrl\n        };\n      });\n      window.wheel = new Winwheel({\n        numSegments: segments.length,\n        responsive: true,\n        innerRadius: size / 2 * 0.08,\n        outerRadius: size / 2 * 0.725,\n        centerY: size / 2 * 0.9,\n        centerX: size / 2,\n        textFontSize: size / 2 * 0.07,\n        lineWidth: 1,\n        segments: segments,\n        animation: {\n          type: \"spinToStop\",\n          easing: \"Power2.easeOut\",\n          duration: 30,\n          spins: 30,\n          callbackSound: \"window.wheelSoundTrigger()\",\n          soundTrigger: \"pin\",\n          callbackFinished: \"window.wheelFinished()\"\n        },\n        pins: {\n          number: segments.length,\n          responsive: true,\n          outerRadius: 1\n        }\n      });\n      window.wheel.rotationAngle = 0;\n      window.wheel.draw();\n    }\n    createWheel();\n    return () => {\n      try {\n        window.wheel.stopAnimation(false);\n      } catch (e) {}\n      window.wheel = null;\n    };\n  }, [players]);\n  return /*#__PURE__*/React.createElement(\"canvas\", {\n    className: style.wheelCanvas,\n    id: \"canvas\",\n    width: size,\n    height: size,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 5\n    }\n  }, \"Canvas not supported, use another browser.\");\n};\nconst Winner = props => {\n  const {\n    info,\n    duration\n  } = props;\n  const [isShow, setShow] = useState(true);\n  function onAnimationEnd(e) {\n    e.target.classList.remove(\"animate__zoomInDown\");\n    setTimeout(() => {\n      e.target.classList.add(\"animate__fadeOut\");\n      e.target.removeEventListener(\"animationend\", onAnimationEnd);\n      e.target.addEventListener(\"animationend\", () => {\n        setShow(false);\n      });\n    }, duration * 1000);\n  }\n  return isShow && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"animate__animated animate__zoomInDown h-100 text-center d-flex flex-column justify-content-center align-items-center\",\n    style: {\n      marginTop: \"-40px\"\n    },\n    onAnimationEnd: onAnimationEnd,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"fw-bolder fs-4 text-info\",\n    style: {\n      textShadow: \"2px 2px 0 #ffffff, 2px -2px 0 #ffffff, -2px 2px 0 #ffffff, -2px -2px 0 #ffffff, 2px 0px 0 #ffffff, 0px 2px 0 #ffffff, -2px 0px 0 #ffffff, 0px -2px 0 #ffffff\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 9\n    }\n  }, \"WINNER\"), /*#__PURE__*/React.createElement(\"img\", {\n    className: \"d-block rounded-circle mx-auto border border-5 border-info\",\n    width: \"150\",\n    height: \"150\",\n    alt: \"winner\",\n    src: info.image,\n    onError: window.imageOnError,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"fw-bolder fs-4 text-info lh-1\",\n    style: {\n      textShadow: \"2px 2px 0 #ffffff, 2px -2px 0 #ffffff, -2px 2px 0 #ffffff, -2px -2px 0 #ffffff, 2px 0px 0 #ffffff, 0px 2px 0 #ffffff, -2px 0px 0 #ffffff, 0px -2px 0 #ffffff\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 9\n    }\n  }, info.name, /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 229,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"small\", {\n    className: \"fs-6\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 11\n    }\n  }, info.text)));\n};\nconst TutorialCard = _ref => {\n  let {\n    settings,\n    playerCount,\n    show\n  } = _ref;\n  const O = {\n    \"b·∫°n b√®\": settings.friend,\n    \"ng∆∞·ªùi theo d√µi\": settings.follower,\n    \"ch∆∞a theo d√µi\": settings.unfollower\n  };\n  const players = [];\n  for (const key in O) {\n    O[key] && players.push(key);\n  }\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      fontSize: \".8rem\",\n      width: \"80%\"\n    },\n    className: \"bg-light border border-1 text-dark text-start p-2 rounded-5 mx-auto animate__animated \" + (show ? \"animate__flipInX\" : \"animate__flipOutX\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    className: \"mb-0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 255,\n      columnNumber: 7\n    }\n  }, \"- Ng\\u01B0\\u1EDDi ch\\u01A1i: \", players.join(\" / \")), /*#__PURE__*/React.createElement(\"p\", {\n    className: \"mb-0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 7\n    }\n  }, \"- \\u0110i\\u1EC1u ki\\u1EC7n:\", \" \", settings.joinEvent === \"chat\" ? /*#__PURE__*/React.createElement(React.Fragment, null, \"comment n\\u1ED9i dung\", /*#__PURE__*/React.createElement(\"span\", {\n    className: \"text-danger ms-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 261,\n      columnNumber: 13\n    }\n  }, settings.commentKey)) : settings.joinEvent === \"gift\" && /*#__PURE__*/React.createElement(React.Fragment, null, \"t\\u1EB7ng t\\u1ED1i thi\\u1EC3u combo\", /*#__PURE__*/React.createElement(\"span\", {\n    className: \"text-danger ms-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 267,\n      columnNumber: 15\n    }\n  }, settings.giftCount, \" \", settings.giftName))), /*#__PURE__*/React.createElement(\"p\", {\n    className: \"mb-0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 274,\n      columnNumber: 7\n    }\n  }, \"- \\u0110\\xE3 tham gia: \", playerCount + \" / \" + settings.maxPlayer), /*#__PURE__*/React.createElement(\"p\", {\n    className: \"mb-0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 277,\n      columnNumber: 7\n    }\n  }, \" \"), /*#__PURE__*/React.createElement(\"p\", {\n    className: \"mb-0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 278,\n      columnNumber: 7\n    }\n  }, \" \"));\n};\nconst JoinedPlayer = _ref2 => {\n  let {\n    players,\n    show\n  } = _ref2;\n  const container = document.getElementById(\"joined-players\");\n  const handleAnimationEnd = e => {\n    e.target.classList.remove(\"animate__backInUp\", \"opacity-100\");\n    setTimeout(() => {\n      e.target.classList.add(\"animate__zoomOut\");\n    }, 3000);\n    e.target.onanimationend = e.target.remove;\n  };\n  useEffect(() => {\n    const lastPlayer = Object.values(players).pop();\n    const image = window.document.createElement(\"img\");\n    image.src = window.imageUrlFixing((lastPlayer === null || lastPlayer === void 0 ? void 0 : lastPlayer.profilePictureUrl) || window.defaultAvatar);\n    image.className = \"position-absolute start-0 top-0 rounded-circle rounded-circle border border-light border-5 opacity-100 animate__animated animate__slow animate__backInUp\";\n    image.setAttribute(\"width\", 80);\n    image.setAttribute(\"height\", 80);\n    image.onanimationend = handleAnimationEnd;\n    image.style.marginLeft = window.randomInt(0, 320) + \"px\";\n    image.style.marginTop = window.randomInt(0, 320) + \"px\";\n    lastPlayer && setTimeout(() => {\n      container.appendChild(image);\n    }, window.randomInt(100, 500));\n  }, [players]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"position-relative \" + (!show && \"animate__animated animate__zoomOut\"),\n    id: \"joined-players\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 315,\n      columnNumber: 5\n    }\n  });\n};\nfunction WheelofFortune(_ref3) {\n  let {\n    isDemo,\n    isProChannel\n  } = _ref3;\n  settings = settings || {};\n  const [isConnected, setIsConnected] = useState(wsocket.connected);\n  const [event, updateEvent] = useState({});\n  const [settings, updateSettings] = useState({});\n  const [players, setPlayers] = useState({});\n  const [canJoin, setCanjoin] = useState(true);\n  const [winner, setWinner] = useState(false);\n  const [isSpining, setIsSpining] = useState(false);\n  function startSpin() {\n    if (Object.keys(players).length < 2 || isSpining) return;\n    window.wheel.rotationAngle = Math.floor(Math.random() * 359) + 1;\n    window.wheel.draw();\n    window.wheel.startAnimation();\n    setCanjoin(false);\n    setWinner(false);\n    setIsSpining(true);\n  }\n  function resetWheel() {\n    try {\n      window.wheel.stopAnimation(false);\n    } catch (e) {}\n    window.wheel.rotationAngle = 0;\n    window.wheel.draw();\n    setPlayers({});\n    setIsSpining(false);\n    setCanjoin(true);\n    setWinner(false);\n  }\n  useEffect(() => {\n    if (!isDemo && !isProChannel) return;\n    const validFollowrRole = {\n      0: settings.unfollower,\n      1: settings.follower,\n      2: settings.friend\n    };\n    const {\n      name,\n      uniqueId,\n      nickname,\n      profilePictureUrl,\n      followRole\n    } = event;\n    if (name === \"spin\") return startSpin();\n    if (name === \"restart\") return resetWheel();\n    setPlayers(current => {\n      const isLimit = Object.keys(current).length >= settings.maxPlayer;\n      if (isLimit || !canJoin) return current;\n      const isJoined = current[uniqueId];\n      if (isJoined || name !== settings.joinEvent || !validFollowrRole[followRole]) return current;\n      var valid;\n      switch (name) {\n        case \"chat\":\n          const {\n            comment\n          } = event;\n          valid = comment && comment.includes(settings.commentKey);\n          break;\n        case \"gift\":\n          const {\n            giftType,\n            giftName,\n            repeatCount,\n            repeatEnd\n          } = event;\n          if (giftType === 1 && !repeatEnd) break;\n          valid = giftName === settings.giftName && repeatCount < settings.giftCount;\n          break;\n        default:\n      }\n      return valid ? {\n        ...current,\n        [uniqueId]: {\n          uniqueId,\n          nickname,\n          profilePictureUrl\n        }\n      } : current;\n    });\n  }, [event, canJoin, settings]);\n  useEffect(() => {\n    window.wheelFinished = () => {\n      let winningSegment = window.wheel.getIndicatedSegment();\n      setWinner(winningSegment.id ? winningSegment : false);\n      setIsSpining(false);\n      console.warn(winningSegment.text, \"is winner\");\n    };\n    wsocket.on(\"connect\", async () => {\n      setIsConnected(true);\n      console.log(\"widget socket connected\");\n    });\n    wsocket.on(\"disconnect\", () => {\n      setIsConnected(false);\n      console.log(\"widget socket disconnected\");\n    });\n    wsocket.on(\"tiktok-chat\", data => {\n      updateEvent(data);\n    });\n    wsocket.on(\"tiktok-gift\", data => {\n      updateEvent(data);\n    });\n    wsocket.on(\"updateSettings\", data => {\n      updateSettings(data);\n    });\n    return () => {\n      window.wheelFinished = null;\n      wsocket.off(\"connect\");\n      wsocket.off(\"disconnect\");\n      wsocket.off(\"updateSettings\");\n      wsocket.off(\"tiktok-chat\");\n      wsocket.off(\"tiktok-gift\");\n    };\n  }, []);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"position-relative mx-auto\",\n    style: {\n      width: `${size}px`,\n      height: `${size}px`\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 442,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(TutorialCard, {\n    settings: settings,\n    playerCount: Object.keys(players).length,\n    show: canJoin,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 446,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"position-absolute w-100 text-center\",\n    style: {\n      zIndex: \"1\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 451,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(JoinedPlayer, {\n    players: players,\n    show: canJoin,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 455,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"position-absolute  \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 457,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Wheel, {\n    players: players,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 458,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"position-absolute w-100 h-100\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 460,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(WheelBackground, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 461,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"position-absolute w-100 h-100\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 463,\n      columnNumber: 7\n    }\n  }, winner && winner.id && /*#__PURE__*/React.createElement(Winner, {\n    info: winner,\n    duration: settings.winnerShowDuration || 10,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 465,\n      columnNumber: 11\n    }\n  })));\n}\nexport default memo(WheelofFortune);","map":{"version":3,"names":["React","useEffect","useState","memo","io","style","Winwheel","cid","URLSearchParams","document","location","search","get","wsocket","path","query","console","log","size","demoPlayer","cao_bay_37","uniqueId","nickname","profilePictureUrl","tuanbo_01","pown_mai_69","quangphucshopee","quanpham14082022","huudai184","facebook_phamcong","trungtutin","utnghia945","window","wheelSoundTrigger","WheelBackground","index","setindex","i","setTimeout","clearTimeout","wheelBg","backgroundImage","Wheel","props","players","createWheel","keys","Object","segments","length","fillStyle","textFillStyle","text","map","player","id","name","image","wheel","numSegments","responsive","innerRadius","outerRadius","centerY","centerX","textFontSize","lineWidth","animation","type","easing","duration","spins","callbackSound","soundTrigger","callbackFinished","pins","number","rotationAngle","draw","stopAnimation","e","wheelCanvas","Winner","info","isShow","setShow","onAnimationEnd","target","classList","remove","add","removeEventListener","addEventListener","marginTop","textShadow","imageOnError","TutorialCard","settings","playerCount","show","O","friend","follower","unfollower","key","push","fontSize","width","join","joinEvent","commentKey","giftCount","giftName","maxPlayer","JoinedPlayer","container","getElementById","handleAnimationEnd","onanimationend","lastPlayer","values","pop","createElement","src","imageUrlFixing","defaultAvatar","className","setAttribute","marginLeft","randomInt","appendChild","WheelofFortune","isDemo","isProChannel","isConnected","setIsConnected","connected","event","updateEvent","updateSettings","setPlayers","canJoin","setCanjoin","winner","setWinner","isSpining","setIsSpining","startSpin","Math","floor","random","startAnimation","resetWheel","validFollowrRole","followRole","current","isLimit","isJoined","valid","comment","includes","giftType","repeatCount","repeatEnd","wheelFinished","winningSegment","getIndicatedSegment","warn","on","data","off","height","zIndex","winnerShowDuration"],"sources":["/Users/trinhdacquang/React/tikgames/src/Widget/index.jsx"],"sourcesContent":["import React, { useEffect, useState, memo } from \"react\"\nimport io from \"socket.io-client\"\nimport style from \"./style.module.css\"\nimport Winwheel from \"winwheel\"\n\nconst cid = new URLSearchParams(document.location.search).get(\"cid\")\nconst wsocket = io(\"/widget\", {\n  path: \"/socket\",\n  query: {\n    cid: cid,\n  },\n})\nconsole.log(wsocket)\nconst size = 400\n\nconst demoPlayer = {\n  cao_bay_37: {\n    uniqueId: \"cao_bay_37\",\n    nickname: \"cao_bay_37-\",\n    profilePictureUrl:\n      \"https://p16-sign-sg.tiktokcdn.com/aweme/100x100/tos-alisg-avt-0068/b7ab24fd72c1d52d9d108b32d0226bec.webp?x-expires=1664269200&x-signature=vis%2BIdLcWF3zJr%2FA47EwW1eR%2FDY%3D\",\n  },\n  tuanbo_01: {\n    uniqueId: \"tuanbo_01\",\n    nickname: \"Tu·∫•n B√≤\",\n    profilePictureUrl:\n      \"https://p16-sign-sg.tiktokcdn.com/aweme/100x100/tiktok-obj/1670424726689794.webp?x-expires=1664269200&x-signature=0L6agIQAKRVwHTLELPBev6Vd6zc%3D\",\n  },\n  pown_mai_69: {\n    uniqueId: \"pown_mai_69\",\n    nickname: \"Con qu·ª∑ ƒëen v√¥ danh\",\n    profilePictureUrl:\n      \"https://p16-sign-sg.tiktokcdn.com/aweme/100x100/tos-alisg-avt-0068/9905f7201fbcfd69cafb8ce0f778e636.webp?x-expires=1664269200&x-signature=huOnbrj1nXEfhRi4HoW1nIJChmk%3D\",\n  },\n  \"3003831393nam\": {\n    uniqueId: \"3003831393nam\",\n    nickname: \"Nam2004‚ô•\",\n    profilePictureUrl:\n      \"https://p16-sign-va.tiktokcdn.com/tos-useast2a-avt-0068-giso/5748581ae3eecff6249d5a89cd4c2065~c5_100x100.webp?x-expires=1664269200&x-signature=hz5JfOVxIOPr3gPx2ex8snZ6Qos%3D\",\n  },\n  quangphucshopee: {\n    uniqueId: \"quangphucshopee\",\n    nickname: \"PhucSadRoi\",\n    profilePictureUrl:\n      \"https://p16-sign-va.tiktokcdn.com/tos-useast2a-avt-0068-giso/439214fa941c4be353b889120a0e69f5~c5_100x100.webp?x-expires=1664269200&x-signature=NeJmP16WXALETssCZlkAcYsnV0o%3D\",\n  },\n  quanpham14082022: {\n    uniqueId: \"quanpham14082022\",\n    nickname: \"Qu√¢nph·∫°m14082022\",\n    profilePictureUrl:\n      \"https://p16-sign-va.tiktokcdn.com/musically-maliva-obj/1594805258216454~c5_100x100.webp?x-expires=1664269200&x-signature=pRXIh6syPbYNGe4QIBGIg0jB0YE%3D\",\n  },\n  huudai184: {\n    uniqueId: \"huudai184\",\n    nickname: \"Nguy·ªÖn H·ªØu ƒê·∫°i\",\n    profilePictureUrl:\n      \"https://p16-sign-sg.tiktokcdn.com/aweme/100x100/tos-alisg-avt-0068/1c0882310d8257e56db42779d703841d.webp?x-expires=1664269200&x-signature=lEL89272xFn1EzI1xXeWKiq2D0I%3D\",\n  },\n  facebook_phamcong: {\n    uniqueId: \"facebook_phamcong\",\n    nickname: \"üçÅ\",\n    profilePictureUrl:\n      \"https://p16-sign-sg.tiktokcdn.com/aweme/100x100/tos-alisg-avt-0068/7c4d3130cea590c23504e44112f89398.webp?x-expires=1664269200&x-signature=KbKC2lqdPD1j5tlRI4SmDN0lA7Y%3D\",\n  },\n  trungtutin: {\n    uniqueId: \"trungtutin\",\n    nickname: \"Trung T·ª± tin\",\n    profilePictureUrl:\n      \"https://p16-sign-sg.tiktokcdn.com/aweme/100x100/tos-alisg-avt-0068/1fe3707fa4397ddcaa82c8f06c39fe9d.webp?x-expires=1664269200&x-signature=EXWc1zZtVx%2Btza9q0z3aReZx5XE%3D\",\n  },\n  utnghia945: {\n    uniqueId: \"utnghia945\",\n    nickname: \"utnghia945\",\n    profilePictureUrl:\n      \"https://p16-sign-va.tiktokcdn.com/tos-useast2a-avt-0068-giso/7144934450743214107~c5_100x100.webp?x-expires=1664269200&x-signature=rNdK6QvOGwDy6t8yKO%2F9LQ4xcIM%3D\",\n  },\n}\n\nwindow.wheelSoundTrigger = () => console.log(\"play sound\")\n\nconst WheelBackground = () => {\n  const [index, setindex] = useState(0)\n\n  useEffect(() => {\n    const i = setTimeout(() => setindex(1 - index), 1000)\n    return () => clearTimeout(i)\n  }, [index])\n\n  return (\n    <>\n      <div\n        className={style.wheelBg + (index ? \" d-none\" : \"\")}\n        style={{\n          backgroundImage: `url('/assets/images/wheel-of-fortune-bg-1.webp')`,\n        }}\n      ></div>\n      <div\n        className={style.wheelBg + (!index ? \" d-none\" : \"\")}\n        style={{\n          backgroundImage: `url('/assets/images/wheel-of-fortune-bg-2.webp')`,\n        }}\n      ></div>\n    </>\n  )\n}\n\nconst Wheel = (props) => {\n  const { players } = props\n\n  useEffect(() => {\n    function createWheel() {\n      const keys = Object.keys(players)\n      const segments = !keys.length\n        ? [\n            {\n              fillStyle: \"#ff0000\",\n              textFillStyle: \"#ff0000\",\n              text: \"\",\n            },\n          ]\n        : keys.map((uniqueId, index) => {\n            const player = players[uniqueId]\n            return {\n              id: player.uniqueId,\n              text: player.uniqueId,\n              name: player.nickname || \"\",\n              fillStyle: index % 2 === 0 ? \"#ff0000\" : \"#ffffff\",\n              textFillStyle: index % 2 === 0 ? \"#ffffff\" : \"#ff0000\",\n              image: player.profilePictureUrl,\n            }\n          })\n      window.wheel = new Winwheel({\n        numSegments: segments.length,\n        responsive: true,\n        innerRadius: (size / 2) * 0.08,\n        outerRadius: (size / 2) * 0.725,\n        centerY: (size / 2) * 0.9,\n        centerX: size / 2,\n        textFontSize: (size / 2) * 0.07,\n        lineWidth: 1,\n        segments: segments,\n        animation: {\n          type: \"spinToStop\",\n          easing: \"Power2.easeOut\",\n          duration: 30,\n          spins: 30,\n          callbackSound: \"window.wheelSoundTrigger()\",\n          soundTrigger: \"pin\",\n          callbackFinished: \"window.wheelFinished()\",\n        },\n        pins: {\n          number: segments.length,\n          responsive: true,\n          outerRadius: 1,\n        },\n      })\n      window.wheel.rotationAngle = 0\n      window.wheel.draw()\n    }\n\n    createWheel()\n\n    return () => {\n      try {\n        window.wheel.stopAnimation(false)\n      } catch (e) {}\n      window.wheel = null\n    }\n  }, [players])\n\n  return (\n    <canvas\n      className={style.wheelCanvas}\n      id=\"canvas\"\n      width={size}\n      height={size}\n    >\n      Canvas not supported, use another browser.\n    </canvas>\n  )\n}\n\nconst Winner = (props) => {\n  const { info, duration } = props\n  const [isShow, setShow] = useState(true)\n\n  function onAnimationEnd(e) {\n    e.target.classList.remove(\"animate__zoomInDown\")\n    setTimeout(() => {\n      e.target.classList.add(\"animate__fadeOut\")\n      e.target.removeEventListener(\"animationend\", onAnimationEnd)\n      e.target.addEventListener(\"animationend\", () => {\n        setShow(false)\n      })\n    }, duration * 1000)\n  }\n  return (\n    isShow && (\n      <div\n        className=\"animate__animated animate__zoomInDown h-100 text-center d-flex flex-column justify-content-center align-items-center\"\n        style={{ marginTop: \"-40px\" }}\n        onAnimationEnd={onAnimationEnd}\n      >\n        <span\n          className=\"fw-bolder fs-4 text-info\"\n          style={{\n            textShadow:\n              \"2px 2px 0 #ffffff, 2px -2px 0 #ffffff, -2px 2px 0 #ffffff, -2px -2px 0 #ffffff, 2px 0px 0 #ffffff, 0px 2px 0 #ffffff, -2px 0px 0 #ffffff, 0px -2px 0 #ffffff\",\n          }}\n        >\n          WINNER\n        </span>\n        <img\n          className=\"d-block rounded-circle mx-auto border border-5 border-info\"\n          width=\"150\"\n          height=\"150\"\n          alt=\"winner\"\n          src={info.image}\n          onError={window.imageOnError}\n        />\n        <span\n          className=\"fw-bolder fs-4 text-info lh-1\"\n          style={{\n            textShadow:\n              \"2px 2px 0 #ffffff, 2px -2px 0 #ffffff, -2px 2px 0 #ffffff, -2px -2px 0 #ffffff, 2px 0px 0 #ffffff, 0px 2px 0 #ffffff, -2px 0px 0 #ffffff, 0px -2px 0 #ffffff\",\n          }}\n        >\n          {info.name}\n          <br />\n          <small className=\"fs-6\">{info.text}</small>\n        </span>\n      </div>\n    )\n  )\n}\n\nconst TutorialCard = ({ settings, playerCount, show }) => {\n  const O = {\n    \"b·∫°n b√®\": settings.friend,\n    \"ng∆∞·ªùi theo d√µi\": settings.follower,\n    \"ch∆∞a theo d√µi\": settings.unfollower,\n  }\n  const players = []\n  for (const key in O) {\n    O[key] && players.push(key)\n  }\n  return (\n    <div\n      style={{ fontSize: \".8rem\", width: \"80%\" }}\n      className={\n        \"bg-light border border-1 text-dark text-start p-2 rounded-5 mx-auto animate__animated \" +\n        (show ? \"animate__flipInX\" : \"animate__flipOutX\")\n      }\n    >\n      <p className=\"mb-0\">- Ng∆∞·ªùi ch∆°i: {players.join(\" / \")}</p>\n      <p className=\"mb-0\">\n        - ƒêi·ªÅu ki·ªán:{\" \"}\n        {settings.joinEvent === \"chat\" ? (\n          <>\n            comment n·ªôi dung\n            <span className=\"text-danger ms-2\">{settings.commentKey}</span>\n          </>\n        ) : (\n          settings.joinEvent === \"gift\" && (\n            <>\n              t·∫∑ng t·ªëi thi·ªÉu combo\n              <span className=\"text-danger ms-2\">\n                {settings.giftCount} {settings.giftName}\n              </span>\n            </>\n          )\n        )}\n      </p>\n      <p className=\"mb-0\">\n        - ƒê√£ tham gia: {playerCount + \" / \" + settings.maxPlayer}\n      </p>\n      <p className=\"mb-0\"> </p>\n      <p className=\"mb-0\"> </p>\n    </div>\n  )\n}\n\nconst JoinedPlayer = ({ players, show }) => {\n  const container = document.getElementById(\"joined-players\")\n\n  const handleAnimationEnd = (e) => {\n    e.target.classList.remove(\"animate__backInUp\", \"opacity-100\")\n    setTimeout(() => {\n      e.target.classList.add(\"animate__zoomOut\")\n    }, 3000)\n    e.target.onanimationend = e.target.remove\n  }\n\n  useEffect(() => {\n    const lastPlayer = Object.values(players).pop()\n    const image = window.document.createElement(\"img\")\n    image.src = window.imageUrlFixing(\n      lastPlayer?.profilePictureUrl || window.defaultAvatar\n    )\n    image.className =\n      \"position-absolute start-0 top-0 rounded-circle rounded-circle border border-light border-5 opacity-100 animate__animated animate__slow animate__backInUp\"\n    image.setAttribute(\"width\", 80)\n    image.setAttribute(\"height\", 80)\n    image.onanimationend = handleAnimationEnd\n    image.style.marginLeft = window.randomInt(0, 320) + \"px\"\n    image.style.marginTop = window.randomInt(0, 320) + \"px\"\n\n    lastPlayer &&\n      setTimeout(() => {\n        container.appendChild(image)\n      }, window.randomInt(100, 500))\n  }, [players])\n\n  return (\n    <div\n      className={\n        \"position-relative \" + (!show && \"animate__animated animate__zoomOut\")\n      }\n      id=\"joined-players\"\n    ></div>\n  )\n}\n\nfunction WheelofFortune({ isDemo, isProChannel }) {\n  settings = settings || {}\n  const [isConnected, setIsConnected] = useState(wsocket.connected)\n  const [event, updateEvent] = useState({})\n  const [settings, updateSettings] = useState({})\n  const [players, setPlayers] = useState({})\n  const [canJoin, setCanjoin] = useState(true)\n  const [winner, setWinner] = useState(false)\n  const [isSpining, setIsSpining] = useState(false)\n\n  function startSpin() {\n    if (Object.keys(players).length < 2 || isSpining) return\n    window.wheel.rotationAngle = Math.floor(Math.random() * 359) + 1\n    window.wheel.draw()\n    window.wheel.startAnimation()\n    setCanjoin(false)\n    setWinner(false)\n    setIsSpining(true)\n  }\n\n  function resetWheel() {\n    try {\n      window.wheel.stopAnimation(false)\n    } catch (e) {}\n    window.wheel.rotationAngle = 0\n    window.wheel.draw()\n    setPlayers({})\n    setIsSpining(false)\n    setCanjoin(true)\n    setWinner(false)\n  }\n\n  useEffect(() => {\n    if (!isDemo && !isProChannel) return\n\n    const validFollowrRole = {\n      0: settings.unfollower,\n      1: settings.follower,\n      2: settings.friend,\n    }\n\n    const { name, uniqueId, nickname, profilePictureUrl, followRole } = event\n\n    if (name === \"spin\") return startSpin()\n    if (name === \"restart\") return resetWheel()\n    setPlayers((current) => {\n      const isLimit = Object.keys(current).length >= settings.maxPlayer\n      if (isLimit || !canJoin) return current\n\n      const isJoined = current[uniqueId]\n      if (\n        isJoined ||\n        name !== settings.joinEvent ||\n        !validFollowrRole[followRole]\n      )\n        return current\n\n      var valid\n      switch (name) {\n        case \"chat\":\n          const { comment } = event\n          valid = comment && comment.includes(settings.commentKey)\n          break\n        case \"gift\":\n          const { giftType, giftName, repeatCount, repeatEnd } = event\n          if (giftType === 1 && !repeatEnd) break\n          valid =\n            giftName === settings.giftName && repeatCount < settings.giftCount\n          break\n        default:\n      }\n      return valid\n        ? { ...current, [uniqueId]: { uniqueId, nickname, profilePictureUrl } }\n        : current\n    })\n  }, [event, canJoin, settings])\n\n  useEffect(() => {\n    window.wheelFinished = () => {\n      let winningSegment = window.wheel.getIndicatedSegment()\n      setWinner(winningSegment.id ? winningSegment : false)\n      setIsSpining(false)\n      console.warn(winningSegment.text, \"is winner\")\n    }\n\n    wsocket.on(\"connect\", async () => {\n      setIsConnected(true)\n      console.log(\"widget socket connected\")\n    })\n\n    wsocket.on(\"disconnect\", () => {\n      setIsConnected(false)\n      console.log(\"widget socket disconnected\")\n    })\n\n    wsocket.on(\"tiktok-chat\", (data) => {\n      updateEvent(data)\n    })\n\n    wsocket.on(\"tiktok-gift\", (data) => {\n      updateEvent(data)\n    })\n\n    wsocket.on(\"updateSettings\", (data) => {\n      updateSettings(data)\n    })\n\n    return () => {\n      window.wheelFinished = null\n      wsocket.off(\"connect\")\n      wsocket.off(\"disconnect\")\n      wsocket.off(\"updateSettings\")\n      wsocket.off(\"tiktok-chat\")\n      wsocket.off(\"tiktok-gift\")\n    }\n  }, [])\n\n  return (\n    <div\n      className=\"position-relative mx-auto\"\n      style={{ width: `${size}px`, height: `${size}px` }}\n    >\n      <TutorialCard\n        settings={settings}\n        playerCount={Object.keys(players).length}\n        show={canJoin}\n      />\n      <div\n        className=\"position-absolute w-100 text-center\"\n        style={{ zIndex: \"1\" }}\n      >\n        <JoinedPlayer players={players} show={canJoin} />\n      </div>\n      <div className=\"position-absolute  \">\n        <Wheel players={players} />\n      </div>\n      <div className=\"position-absolute w-100 h-100\">\n        <WheelBackground />\n      </div>\n      <div className=\"position-absolute w-100 h-100\">\n        {winner && winner.id && (\n          <Winner info={winner} duration={settings.winnerShowDuration || 10} />\n        )}\n      </div>\n    </div>\n  )\n}\nexport default memo(WheelofFortune)\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}